+++
date = "2004-08-22T00:00:00+01:00"
lastmod = "2004-08-22T00:00:00+01:00"
author = "Albert L.G."
title = "PageRank revisat"
slug = "pagerank-revised-81895"
tags = [ "seo" ]
+++

<p>Com haureu pogut observar, al menú de la dreta, per sobre del calendari, us mostro el PageRank del meu weblog... sense necessitat de tenir la ToolBar de Google!</p>
<p>I què significa això? Doncs que utilitzo un codi <acronym title="Hypertext Preprocessor">PHP</acronym>, juntament amb <acronym title="Server Side Include">SSI</acronym> per calcular-lo i mostrar-vos-el.</p>
<p>Voleu veure el codi?</p>
<pre>define('GMAG', 0xE6359A60);<br /><br /><p>//unsigned shift right<br /><br />function zeroFill($a, $b){<br /><br />  $z = hexdec(80000000);<br /><br />  if ($z &amp; $a){<br /><br />    $a = ($a&gt;&gt;1);<br /><br />    $a &amp;= (~$z);<br /><br />    $a |= 0x40000000;<br /><br />    $a = ($a&gt;&gt;($b-1));<br /><br />  }else{<br /><br />    $a = ($a&gt;&gt;$b);<br /><br />  }<br /><br />  return $a;<br /><br />}</p><br /><br /><p>function mix($a,$b,$c){<br /><br />  $a -= $b; $a -= $c; $a ^= (zeroFill($c,13));<br /><br />  $b -= $c; $b -= $a; $b ^= ($a&lt;&lt;8);<br /><br />  $c -= $a; $c -= $b; $c ^= (zeroFill($b,13));<br /><br />  $a -= $b; $a -= $c; $a ^= (zeroFill($c,12));<br /><br />  $b -= $c; $b -= $a; $b ^= ($a&lt;&lt;16);<br /><br />  $c -= $a; $c -= $b; $c ^= (zeroFill($b,5));<br /><br />  $a -= $b; $a -= $c; $a ^= (zeroFill($c,3));<br /><br />  $b -= $c; $b -= $a; $b ^= ($a&lt;&lt;10);<br /><br />  $c -= $a; $c -= $b; $c ^= (zeroFill($b,15));<br /><br />return array($a,$b,$c);<br /><br />}</p><br /><br /><p>function GCH($url, $length=null, $init=GMAG){<br /><br />  if(is_null($length)){<br /><br />    $length = sizeof($url);<br /><br />  }<br /><br />  $a = $b = 0x9E3779B9;<br /><br />  $c = $init;<br /><br />  $k = 0;<br /><br />  $len = $length;<br /><br />  while($len &gt;= 12){<br /><br />    $a += ($url[$k+0] +($url[$k+1]&lt;&lt;8) +($url[$k+2]&lt;&lt;16) <br /><br />      +($url[$k+3]&lt;&lt;24));<br /><br />    $b += ($url[$k+4] +($url[$k+5]&lt;&lt;8) +($url[$k+6]&lt;&lt;16) <br /><br />      +($url[$k+7]&lt;&lt;24));<br /><br />    $c += ($url[$k+8] +($url[$k+9]&lt;&lt;8) +($url[$k+10]&lt;&lt;16) <br /><br />      +($url[$k+11]&lt;&lt;24));<br /><br />    $mix = mix($a,$b,$c);<br /><br />    $a = $mix[0]; $b = $mix[1]; $c = $mix[2];<br /><br />    $k += 12;<br /><br />    $len -= 12;<br /><br />  }<br /><br />  $c += $length;<br /><br />  switch($len){  // all the case statements fall through<br /><br />    case 11: $c+=($url[$k+10]&lt;&lt;24);<br /><br />    case 10: $c+=($url[$k+9]&lt;&lt;16);<br /><br />    case 9 : $c+=($url[$k+8]&lt;&lt;8);<br /><br />      // the first byte of c is reserved for the length<br /><br />    case 8 : $b+=($url[$k+7]&lt;&lt;24);<br /><br />    case 7 : $b+=($url[$k+6]&lt;&lt;16);<br /><br />    case 6 : $b+=($url[$k+5]&lt;&lt;8);<br /><br />    case 5 : $b+=($url[$k+4]);<br /><br />    case 4 : $a+=($url[$k+3]&lt;&lt;24);<br /><br />    case 3 : $a+=($url[$k+2]&lt;&lt;16);<br /><br />    case 2 : $a+=($url[$k+1]&lt;&lt;8);<br /><br />    case 1 : $a+=($url[$k+0]);<br /><br />      // case 0: nothing left to add<br /><br />  }<br /><br />  $mix = mix($a,$b,$c);<br /><br />    // report the result<br /><br />  return $mix[2];<br /><br />}</p><br /><br /><p>//converts a string into an array of integers (the numeric<br /><br />//value of the char)<br /><br />function strord($string){<br /><br />  for($i=0;$i<br /><br />    $result[$i] = ord($string{$i});<br /><br />  }<br /><br />  return $result;<br /><br />}</p><br /><br /><p>function getPR($_url){<br /><br />  $url = 'info:'.$_url;<br /><br />  $ch = GCH(strord($url));<br /><br />  $url='info:'.urlencode($_url);<br /><br />  $pr = file("http://www.google.com/search?client=<br /><br />    navclient-auto&amp;ch=6$ch&amp;ie=UTF-8&amp;oe=UTF-8&amp;<br /><br />    features=Rank&amp;q=$url");<br /><br />  $pr_str = implode("", $pr);<br /><br />  return substr($pr_str,strrpos($pr_str, ":")+1);<br /><br />}<br /><br />echo "Mi PR es: ".getPR("http://www.albertlg.com/blog/")."";<br /><br />?&gt;</p></pre>
